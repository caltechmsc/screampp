#!/usr/bin/perl

BEGIN {
    use FindBin qw($Bin);
    use lib $FindBin::Bin;
}

use Cwd;
use File::Basename;
use File::Copy;
use File::Path;
use File::Spec;
use Getopt::Long qw(:config no_ignore_case);
use List::Util qw(min max);
use POSIX qw(ceil floor);
use Sys::Hostname;
use Time::Local;

if ($ARGV[0] =~ /^(charmm|charmm_n|amber|amber_n|qeq|qeq_n)$/) {
    $chargetype = $ARGV[0];
} else {
    $chargetype = "charmm";
}

###
### Charge Data
###
my $chgdat =
"
res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
ALA  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
ALA  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
ALA  CA    C_3    back   0.07000   0.03370  -0.03165   0.07000   0.03370  -0.03165
ALA  HCA   H_     back   0.09000   0.08230   0.22426   0.09000   0.08230   0.22426
ALA  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
ALA  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
ALA  CB    C_3    side  -0.27000  -0.18250  -0.31035  -0.27000  -0.18250  -0.31035
ALA  HCB   H_     side   0.09000   0.06030   0.10345   0.09000   0.06030   0.10345
ALA  HCB   H_     side   0.09000   0.06030   0.10345   0.09000   0.06030   0.10345
ALA  HCB   H_     side   0.09000   0.06030   0.10345   0.09000   0.06030   0.10345

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
ARG  N     N_R    back  -0.47000  -0.34790  -0.36910  -0.47000  -0.38957  -0.36910
ARG  HN    H___A  back   0.31000   0.27470   0.25090   0.31000   0.23303   0.25090
ARG  CA    C_3    back   0.07000  -0.26370  -0.03165   0.07000  -0.30537  -0.03165
ARG  HCA   H_     back   0.09000   0.15600   0.22426   0.09000   0.11433   0.22426
ARG  C     C_R    back   0.51000   0.73410   0.27455   0.51000   0.69243   0.27455
ARG  O     O_2    back  -0.51000  -0.58940  -0.34896  -0.51000  -0.63107  -0.34896
ARG  CB    C_3    side  -0.18000  -0.00070   0.04112  -0.23556  -0.04237  -0.01444
ARG  HCB   H_     side   0.09000   0.03270   0.13860   0.03444  -0.00897   0.08304
ARG  HCB   H_     side   0.09000   0.03270   0.13860   0.03444  -0.00897   0.08304
ARG  CG    C_3    side  -0.18000   0.03900  -0.18095  -0.23556  -0.00267  -0.23651
ARG  HCG   H_     side   0.09000   0.02850   0.15754   0.03444  -0.01317   0.10198
ARG  HCG   H_     side   0.09000   0.02850   0.15754   0.03444  -0.01317   0.10198
ARG  CD    C_3    side   0.20000   0.04860  -0.11897   0.14444   0.00693  -0.17453
ARG  HCD   H_     side   0.09000   0.06870   0.15550   0.03444   0.02703   0.09994
ARG  HCD   H_     side   0.09000   0.06870   0.15550   0.03444   0.02703   0.09994
ARG  NE    N_R    side  -0.70000  -0.52950  -0.39834  -0.75556  -0.57117  -0.45390
ARG  HNE   H___A  side   0.44000   0.34560   0.22855   0.38444   0.30393   0.17299
ARG  CZ    C_R    side   0.64000   0.80760   0.35575   0.58444   0.76593   0.30019
ARG  NH1   N_R    side  -0.80000  -0.86270  -0.36186  -0.85556  -0.90437  -0.41742
ARG  HNH1  H___A  side   0.46000   0.44780   0.22332   0.40444   0.40613   0.16776
ARG  HNH1  H___A  side   0.46000   0.44780   0.22332   0.40444   0.40613   0.16776
ARG  NH2   N_R    side  -0.80000  -0.86270  -0.36186  -0.85556  -0.90437  -0.41742
ARG  HNH2  H___A  side   0.46000   0.44780   0.22332   0.40444   0.40613   0.16776
ARG  HNH2  H___A  side   0.46000   0.44780   0.22332   0.40444   0.40613   0.16776

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
ARN  N     N_R    back  -0.47000  -0.61425  -0.36910  -0.47000  -0.61425  -0.36910
ARN  HN    H___A  back   0.31000   0.37526   0.25090   0.31000   0.37526   0.25090
ARN  CA    C_3    back   0.07000  -0.04834  -0.03165   0.07000  -0.04834  -0.03165
ARN  HCA   H_     back   0.09000   0.09546   0.22426   0.09000   0.09546   0.22426
ARN  C     C_R    back   0.51000   0.68923   0.27455   0.51000   0.68923   0.27455
ARN  O     O_2    back  -0.51000  -0.60332  -0.34896  -0.51000  -0.60332  -0.34896
ARN  CB    C_3    side  -0.18000   0.02335  -0.22811  -0.18000   0.02335  -0.22811
ARN  HCB   H_     side   0.09000   0.03300   0.12098   0.09000   0.03300   0.12098
ARN  HCB   H_     side   0.09000   0.03300   0.12098   0.09000   0.03300   0.12098
ARN  CG    C_3    side  -0.18000   0.15920  -0.25695  -0.18000   0.15920  -0.25695
ARN  HCG   H_     side   0.09000  -0.05893   0.14014   0.09000  -0.05893   0.14014
ARN  HCG   H_     side   0.09000  -0.05893   0.14014   0.09000  -0.05893   0.14014
ARN  CD    C_3    side  -0.13000   0.20895  -0.16789  -0.13000   0.20895  -0.16789
ARN  HCD   H_     side   0.09000   0.02506   0.14004   0.09000   0.02506   0.14004
ARN  HCD   H_     side   0.09000   0.02506   0.14004   0.09000   0.02506   0.14004
ARN  NE    N_RP   side  -0.81000  -0.86040  -0.40336  -0.81000  -0.86040  -0.40336
ARN  HNE   H___A  side   0.44000   0.37571   0.21376   0.44000   0.37571   0.21376
ARN  CZ    C_R    side   0.82000   0.91886   0.33877   0.82000   0.91886   0.33877
ARN  NH1   N_RP   side  -0.91000  -0.91983  -0.46547  -0.91000  -0.91983  -0.46547
ARN  HNH1  H___A  side   0.44000   0.39274   0.16592   0.44000   0.39274   0.16592
ARN  HNH1  H___A  side   0.44000   0.39274   0.16592   0.44000   0.39274   0.16592
ARN  NH2   N_RP   side  -0.91000  -0.94281  -0.35731  -0.91000  -0.94281  -0.35731
ARN  HNH2  H___A  side   0.44000   0.35919   0.19240   0.44000   0.35919   0.19240

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
ASN  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
ASN  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
ASN  CA    C_3    back   0.07000   0.01430  -0.03165   0.07000   0.01430  -0.03165
ASN  HCA   H_     back   0.09000   0.10480   0.22426   0.09000   0.10480   0.22426
ASN  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
ASN  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
ASN  CB    C_3    side  -0.18000  -0.20410  -0.09598  -0.18000  -0.20410  -0.09598
ASN  HCB   H_     side   0.09000   0.07970   0.09885   0.09000   0.07970   0.09885
ASN  HCB   H_     side   0.09000   0.07970   0.09885   0.09000   0.07970   0.09885
ASN  CG    C_R    side   0.55000   0.71300   0.33686   0.55000   0.71300   0.33686
ASN  OD1   O_2    side  -0.55000  -0.59310  -0.33489  -0.55000  -0.59310  -0.33489
ASN  ND2   N_R    side  -0.62000  -0.91910  -0.45603  -0.62000  -0.91910  -0.45603
ASN  HND2  H___A  side   0.31000   0.41960   0.17617   0.31000   0.41960   0.17617
ASN  HND2  H___A  side   0.31000   0.41960   0.17617   0.31000   0.41960   0.17617

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
ASP  N     N_R    back  -0.47000  -0.51630  -0.36910  -0.47000  -0.43297  -0.36910
ASP  HN    H___A  back   0.31000   0.29360   0.25090   0.31000   0.37693   0.25090
ASP  CA    C_3    back   0.07000   0.03810  -0.03165   0.07000   0.12143  -0.03165
ASP  HCA   H_     back   0.09000   0.08800   0.22426   0.09000   0.17133   0.22426
ASP  C     C_R    back   0.51000   0.53660   0.27455   0.51000   0.61993   0.27455
ASP  O     O_2    back  -0.51000  -0.58190  -0.34896  -0.51000  -0.49857  -0.34896
ASP  CB    C_3    side  -0.28000  -0.03030  -0.45611  -0.11333   0.05303  -0.28944
ASP  HCB   H_     side   0.09000  -0.01220   0.06274   0.25667   0.07113   0.22941
ASP  HCB   H_     side   0.09000  -0.01220   0.06274   0.25667   0.07113   0.22941
ASP  CG    C_R    side   0.62000   0.79940   0.26585   0.78667   0.88273   0.43252
ASP  OD1   O_2    side  -0.76000  -0.80140  -0.46761  -0.59333  -0.71807  -0.30094
ASP  OD2   O_2    side  -0.76000  -0.80140  -0.46761  -0.59333  -0.71807  -0.30094

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
APP  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
APP  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
APP  CA    C_3    back   0.07000   0.03410  -0.03165   0.07000   0.03410  -0.03165
APP  HCA   H_     back   0.09000   0.08640   0.22426   0.09000   0.08640   0.22426
APP  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
APP  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
APP  CB    C_3    side  -0.21000  -0.03160  -0.05173  -0.21000  -0.03160  -0.05173
APP  HCB   H_     side   0.09000   0.04880   0.10082   0.09000   0.04880   0.10082
APP  HCB   H_     side   0.09000   0.04880   0.10082   0.09000   0.04880   0.10082
APP  CG    C_R    side   0.75000   0.64620   0.38896   0.75000   0.64620   0.38896
APP  OD1   O_3M   side  -0.61000  -0.55540  -0.34924  -0.61000  -0.55540  -0.34924
APP  OD2   O_2M   side  -0.55000  -0.63760  -0.43699  -0.55000  -0.63760  -0.43699
APP  HOD2  H___A  side   0.44000   0.47470   0.24736   0.44000   0.47470   0.24736

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
CYS  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
CYS  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
CYS  CA    C_3    back   0.07000   0.02130  -0.03165   0.07000   0.02130  -0.03165
CYS  HCA   H_     back   0.09000   0.11240   0.22426   0.09000   0.11240   0.22426
CYS  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
CYS  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
CYS  CB    C_3    side  -0.11000  -0.12310  -0.32387  -0.11000  -0.12310  -0.32387
CYS  HCB   H_     side   0.09000   0.11120   0.10106   0.09000   0.11120   0.10106
CYS  HCB   H_     side   0.09000   0.11120   0.10106   0.09000   0.11120   0.10106
CYS  SG    S_3    side  -0.23000  -0.31190   0.07757  -0.23000  -0.31190   0.07757
CYS  HSG   H___A  side   0.16000   0.19330   0.04418   0.16000   0.19330   0.04418

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
CYX  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
CYX  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
CYX  CA    C_3    back   0.07000   0.04290  -0.03165   0.07000   0.04290  -0.03165
CYX  HCA   H_     back   0.09000   0.07660   0.22426   0.09000   0.07660   0.22426
CYX  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
CYX  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
CYX  CB    C_3    side  -0.10000  -0.07900  -0.32387  -0.10000  -0.07900  -0.32387
CYX  HCB   H_     side   0.09000   0.09100   0.10106   0.09000   0.09100   0.10106
CYX  HCB   H_     side   0.09000   0.09100   0.10106   0.09000   0.09100   0.10106
CYX  SG    S_3    side  -0.08000  -0.10810   0.12175  -0.08000  -0.10810   0.12175

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
GLN  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
GLN  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
GLN  CA    C_3    back   0.07000  -0.00310  -0.03165   0.07000  -0.00310  -0.03165
GLN  HCA   H_     back   0.09000   0.08500   0.22426   0.09000   0.08500   0.22426
GLN  C     C_2    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
GLN  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
GLN  CB    C_3    side  -0.18000  -0.00360  -0.20453  -0.18000  -0.00360  -0.20453
GLN  HCB   H_     side   0.09000   0.01710   0.12408   0.09000   0.01710   0.12408
GLN  HCB   H_     side   0.09000   0.01710   0.12408   0.09000   0.01710   0.12408
GLN  CG    C_3    side  -0.18000  -0.06450  -0.15067  -0.18000  -0.06450  -0.15067
GLN  HCG   H_     side   0.09000   0.03520   0.11527   0.09000   0.03520   0.11527
GLN  HCG   H_     side   0.09000   0.03520   0.11527   0.09000   0.03520   0.11527
GLN  CD    C_R    side   0.55000   0.69510   0.31957   0.55000   0.69510   0.31957
GLN  OE1   O_2    side  -0.55000  -0.60860  -0.33646  -0.55000  -0.60860  -0.33646
GLN  NE2   N_R    side  -0.62000  -0.94070  -0.45883  -0.62000  -0.94070  -0.45883
GLN  HNE2  H___A  side   0.31000   0.42510   0.17611   0.31000   0.42510   0.17611
GLN  HNE2  H___A  side   0.31000   0.42510   0.17611   0.31000   0.42510   0.17611

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
GLU  N     N_R    back  -0.47000  -0.51630  -0.36910  -0.47000  -0.44963  -0.36910
GLU  HN    H___A  back   0.31000   0.29360   0.25090   0.31000   0.36027   0.25090
GLU  CA    C_3    back   0.07000   0.03970  -0.03165   0.07000   0.10637  -0.03165
GLU  HCA   H_     back   0.09000   0.11050   0.22426   0.09000   0.17717   0.22426
GLU  C     C_R    back   0.51000   0.53660   0.27455   0.51000   0.60327   0.27455
GLU  O     O_2    back  -0.51000  -0.58190  -0.34896  -0.51000  -0.51523  -0.34896
GLU  CB    C_3    side  -0.18000   0.05600  -0.53325  -0.06889   0.12267  -0.42214
GLU  HCB   H_     side   0.09000  -0.01730   0.10270   0.20111   0.04937   0.21381
GLU  HCB   H_     side   0.09000  -0.01730   0.10270   0.20111   0.04937   0.21381
GLU  CG    C_3    side  -0.28000   0.01360  -0.23692  -0.16889   0.08027  -0.12581
GLU  HCG   H_     side   0.09000  -0.04250   0.08374   0.20111   0.02417   0.19485
GLU  HCG   H_     side   0.09000  -0.04250   0.08374   0.20111   0.02417   0.19485
GLU  CD    C_R    side   0.62000   0.80540   0.30771   0.73111   0.87207   0.41882
GLU  OE1   O_2    side  -0.76000  -0.81880  -0.45521  -0.64889  -0.75213  -0.34410
GLU  OE2   O_2    side  -0.76000  -0.81880  -0.45521  -0.64889  -0.75213  -0.34410

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
GLP  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
GLP  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
GLP  CA    C_3    back   0.07000   0.01450  -0.03165   0.07000   0.01450  -0.03165
GLP  HCA   H_     back   0.09000   0.07790   0.22426   0.09000   0.07790   0.22426
GLP  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
GLP  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
GLP  CB    C_3    side  -0.18000  -0.00710  -0.19610  -0.18000  -0.00710  -0.19610
GLP  HCB   H_     side   0.09000   0.02560   0.12419   0.09000   0.02560   0.12419
GLP  HCB   H_     side   0.09000   0.02560   0.12419   0.09000   0.02560   0.12419
GLP  CG    C_3    side  -0.21000  -0.01740  -0.11545  -0.21000  -0.01740  -0.11545
GLP  HCG   H_     side   0.09000   0.04300   0.11777   0.09000   0.04300   0.11777
GLP  HCG   H_     side   0.09000   0.04300   0.11777   0.09000   0.04300   0.11777
GLP  CD    C_R    side   0.75000   0.68010   0.37000   0.75000   0.68010   0.37000
GLP  OE1   O_3M   side  -0.61000  -0.58380  -0.35092  -0.61000  -0.58380  -0.35092
GLP  OE2   O_2M   side  -0.55000  -0.65110  -0.43933  -0.55000  -0.65110  -0.43933
GLP  HOE2  H___A  side   0.44000   0.46410   0.24788   0.44000   0.46410   0.24788

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
GLY  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
GLY  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
GLY  CA    C_3    back  -0.02000  -0.02520  -0.03165  -0.02000  -0.02520  -0.03165
GLY  HCA   H_     back   0.09000   0.06980   0.11213   0.09000   0.06980   0.11213
GLY  HCA   H_     back   0.09000   0.06980   0.11213   0.09000   0.06980   0.11213
GLY  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
GLY  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
HIS  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
HIS  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
HIS  CA    C_3    back   0.07000   0.01880  -0.03165   0.07000   0.01880  -0.03165
HIS  HCA   H_     back   0.09000   0.08810   0.22426   0.09000   0.08810   0.22426
HIS  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
HIS  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
HIS  CB    C_3    side  -0.09000  -0.04620  -0.20100  -0.09000  -0.04620  -0.20100
HIS  HCB   H_     side   0.09000   0.04020   0.09987   0.09000   0.04020   0.09987
HIS  HCB   H_     side   0.09000   0.04020   0.09987   0.09000   0.04020   0.09987
HIS  CG    C_R    side  -0.05000  -0.02660   0.08262  -0.05000  -0.02660   0.08262
HIS  ND1   N_R    side  -0.36000  -0.38110  -0.43297  -0.36000  -0.38110  -0.43297
HIS  HND1  H___A  side   0.32000   0.36490   0.17465   0.32000   0.36490   0.17465
HIS  CD2   C_R    side   0.22000   0.12920   0.11053   0.22000   0.12920   0.11053
HIS  HCD2  H_     side   0.10000   0.11470   0.09882   0.10000   0.11470   0.09882
HIS  CE1   C_R    side   0.25000   0.20570   0.16763   0.25000   0.20570   0.16763
HIS  HCE1  H_     side   0.13000   0.13920   0.12406   0.13000   0.13920   0.12406
HIS  NE2   N_R    side  -0.70000  -0.57270  -0.32408  -0.70000  -0.57270  -0.32408

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
HSD  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
HSD  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
HSD  CA    C_3    back   0.07000   0.01880  -0.03165   0.07000   0.01880  -0.03165
HSD  HCA   H_     back   0.09000   0.08810   0.22426   0.09000   0.08810   0.22426
HSD  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
HSD  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
HSD  CB    C_3    side  -0.09000  -0.04620  -0.20100  -0.09000  -0.04620  -0.20100
HSD  HCB   H_     side   0.09000   0.04020   0.09987   0.09000   0.04020   0.09987
HSD  HCB   H_     side   0.09000   0.04020   0.09987   0.09000   0.04020   0.09987
HSD  CG    C_R    side  -0.05000  -0.02660   0.08262  -0.05000  -0.02660   0.08262
HSD  ND1   N_R    side  -0.36000  -0.38110  -0.43297  -0.36000  -0.38110  -0.43297
HSD  HND1  H___A  side   0.32000   0.36490   0.17465   0.32000   0.36490   0.17465
HSD  CD2   C_R    side   0.22000   0.12920   0.11053   0.22000   0.12920   0.11053
HSD  HCD2  H_     side   0.10000   0.11470   0.09882   0.10000   0.11470   0.09882
HSD  CE1   C_R    side   0.25000   0.20570   0.16763   0.25000   0.20570   0.16763
HSD  HCE1  H_     side   0.13000   0.13920   0.12406   0.13000   0.13920   0.12406
HSD  NE2   N_R    side  -0.70000  -0.57270  -0.32408  -0.70000  -0.57270  -0.32408

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
HSE  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
HSE  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
HSE  CA    C_3    back   0.07000  -0.05810  -0.03165   0.07000  -0.05810  -0.03165
HSE  HCA   H_     back   0.09000   0.13600   0.22426   0.09000   0.13600   0.22426
HSE  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
HSE  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
HSE  CB    C_3    side  -0.08000  -0.00740  -0.18043  -0.08000  -0.00740  -0.18043
HSE  HCB   H_     side   0.09000   0.03670   0.09798   0.09000   0.03670   0.09798
HSE  HCB   H_     side   0.09000   0.03670   0.09798   0.09000   0.03670   0.09798
HSE  CG    C_R    side   0.22000   0.18680   0.15696   0.22000   0.18680   0.15696
HSE  ND1   N_R    side  -0.70000  -0.54320  -0.32113  -0.70000  -0.54320  -0.32113
HSE  CD2   C_R    side  -0.05000  -0.22070   0.02266  -0.05000  -0.22070   0.02266
HSE  HCD2  H_     side   0.09000   0.18620   0.09941   0.09000   0.18620   0.09941
HSE  CE1   C_R    side   0.25000   0.16350   0.16607   0.25000   0.16350   0.16607
HSE  HCE1  H_     side   0.13000   0.14350   0.12675   0.13000   0.14350   0.12675
HSE  NE2   N_R    side  -0.36000  -0.27950  -0.44208  -0.36000  -0.27950  -0.44208
HSE  HNE2  H___A  side   0.32000   0.33390   0.17583   0.32000   0.33390   0.17583

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
HSP  N     N_R    back  -0.47000  -0.34790  -0.36910  -0.47000  -0.40346  -0.36910
HSP  HN    H___A  back   0.31000   0.27470   0.25090   0.31000   0.21914   0.25090
HSP  CA    C_3    back   0.07000  -0.13540  -0.03165   0.07000  -0.19096  -0.03165
HSP  HCA   H_     back   0.09000   0.12120   0.22426   0.09000   0.06564   0.22426
HSP  C     C_R    back   0.51000   0.73410   0.27455   0.51000   0.67854   0.27455
HSP  O     O_2    back  -0.51000  -0.58940  -0.34896  -0.51000  -0.64496  -0.34896
HSP  CB    C_3    side  -0.05000  -0.04140   0.11159  -0.13333  -0.09696   0.02826
HSP  HCB   H_     side   0.09000   0.08100   0.13227   0.00667   0.02544   0.04894
HSP  HCB   H_     side   0.09000   0.08100   0.13227   0.00667   0.02544   0.04894
HSP  CG    C_R    side   0.19000  -0.00120   0.07366   0.10667  -0.05676  -0.00967
HSP  ND1   N_R    side  -0.51000  -0.15130  -0.39632  -0.59333  -0.20686  -0.47965
HSP  HND1  H___A  side   0.44000   0.38660   0.23076   0.35667   0.33104   0.14743
HSP  CD2   C_R    side   0.19000  -0.11410   0.17056   0.10667  -0.16966   0.08723
HSP  HCD2  H_     side   0.13000   0.23170   0.15648   0.04667   0.17614   0.07315
HSP  CE1   C_R    side   0.32000  -0.01700   0.31365   0.23667  -0.07256   0.23032
HSP  HCE1  H_     side   0.18000   0.26810   0.19363   0.09667   0.21254   0.11030
HSP  NE2   N_R    side  -0.51000  -0.17180  -0.37011  -0.59333  -0.22736  -0.45344
HSP  HNE2  H___A  side   0.44000   0.39110   0.25156   0.35667   0.33554   0.16823

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
ILE  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
ILE  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
ILE  CA    C_3    back   0.07000  -0.05970  -0.03165   0.07000  -0.05970  -0.03165
ILE  HCA   H_     back   0.09000   0.08690   0.22426   0.09000   0.08690   0.22426
ILE  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
ILE  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
ILE  CB    C_3    side  -0.09000   0.13030  -0.15135  -0.09000   0.13030  -0.15135
ILE  HCB   H_     side   0.09000   0.01870   0.14201   0.09000   0.01870   0.14201
ILE  CG1   C_3    side  -0.18000  -0.04300  -0.24965  -0.18000  -0.04300  -0.24965
ILE  HCG1  H_     side   0.09000   0.02360   0.13486   0.09000   0.02360   0.13486
ILE  HCG1  H_     side   0.09000   0.02360   0.13486   0.09000   0.02360   0.13486
ILE  CG2   C_3    side  -0.27000  -0.32040  -0.32482  -0.27000  -0.32040  -0.32482
ILE  HCG2  H_     side   0.09000   0.08820   0.11175   0.09000   0.08820   0.11175
ILE  HCG2  H_     side   0.09000   0.08820   0.11175   0.09000   0.08820   0.11175
ILE  HCG2  H_     side   0.09000   0.08820   0.11175   0.09000   0.08820   0.11175
ILE  CD1   C_3    side  -0.27000  -0.06600  -0.36703  -0.27000  -0.06600  -0.36703
ILE  HCD1  H_     side   0.09000   0.01860   0.11529   0.09000   0.01860   0.11529
ILE  HCD1  H_     side   0.09000   0.01860   0.11529   0.09000   0.01860   0.11529
ILE  HCD1  H_     side   0.09000   0.01860   0.11529   0.09000   0.01860   0.11529

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
LEU  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
LEU  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
LEU  CA    C_3    back   0.07000  -0.05180  -0.03165   0.07000  -0.05180  -0.03165
LEU  HCA   H_     back   0.09000   0.09220   0.22426   0.09000   0.09220   0.22426
LEU  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
LEU  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
LEU  CB    C_3    side  -0.18000  -0.11020  -0.21651  -0.18000  -0.11020  -0.21651
LEU  HCB   H_     side   0.09000   0.04570   0.12156   0.09000   0.04570   0.12156
LEU  HCB   H_     side   0.09000   0.04570   0.12156   0.09000   0.04570   0.12156
LEU  CG    C_3    side  -0.09000   0.35310  -0.20671  -0.09000   0.35310  -0.20671
LEU  HCG   H_     side   0.09000  -0.03610   0.15596   0.09000  -0.03610   0.15596
LEU  CD1   C_3    side  -0.27000  -0.41210  -0.33554  -0.27000  -0.41210  -0.33554
LEU  HCD1  H_     side   0.09000   0.10000   0.11587   0.09000   0.10000   0.11587
LEU  HCD1  H_     side   0.09000   0.10000   0.11587   0.09000   0.10000   0.11587
LEU  HCD1  H_     side   0.09000   0.10000   0.11587   0.09000   0.10000   0.11587
LEU  CD2   C_3    side  -0.27000  -0.41210  -0.33554  -0.27000  -0.41210  -0.33554
LEU  HCD2  H_     side   0.09000   0.10000   0.11587   0.09000   0.10000   0.11587
LEU  HCD2  H_     side   0.09000   0.10000   0.11587   0.09000   0.10000   0.11587
LEU  HCD2  H_     side   0.09000   0.10000   0.11587   0.09000   0.10000   0.11587

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
LYS  N     N_R    back  -0.47000  -0.34790  -0.36910  -0.47000  -0.39335  -0.36910
LYS  HN    H___A  back   0.31000   0.27470   0.25090   0.31000   0.22925   0.25090
LYS  CA    C_3    back   0.07000  -0.24000  -0.03165   0.07000  -0.28545  -0.03165
LYS  HCA   H_     back   0.09000   0.14260   0.22426   0.09000   0.09715   0.22426
LYS  C     C_R    back   0.51000   0.73410   0.27455   0.51000   0.68865   0.27455
LYS  O     O_2    back  -0.51000  -0.58940  -0.34896  -0.51000  -0.63485  -0.34896
LYS  CB    C_3    side  -0.18000  -0.00940   0.06649  -0.24250  -0.05485   0.00399
LYS  HCB   H_     side   0.09000   0.03620   0.14652   0.02750  -0.00925   0.08402
LYS  HCB   H_     side   0.09000   0.03620   0.14652   0.02750  -0.00925   0.08402
LYS  CG    C_3    side  -0.18000   0.01870  -0.18440  -0.24250  -0.02675  -0.24690
LYS  HCG   H_     side   0.09000   0.01030   0.16052   0.02750  -0.03515   0.09802
LYS  HCG   H_     side   0.09000   0.01030   0.16052   0.02750  -0.03515   0.09802
LYS  CD    C_3    side  -0.18000  -0.04790  -0.23456  -0.24250  -0.09335  -0.29706
LYS  HCD   H_     side   0.09000   0.06210   0.16257   0.02750   0.01665   0.10007
LYS  HCD   H_     side   0.09000   0.06210   0.16257   0.02750   0.01665   0.10007
LYS  CE    C_3    side   0.21000  -0.01430  -0.12261   0.14750  -0.05975  -0.18511
LYS  HCE   H_     side   0.05000   0.11350   0.18025  -0.01250   0.06805   0.11775
LYS  HCE   H_     side   0.05000   0.11350   0.18025  -0.01250   0.06805   0.11775
LYS  NZ    N_3    side  -0.30000  -0.38540  -0.47012  -0.36250  -0.43085  -0.53262
LYS  HNZ   H___A  side   0.33000   0.34000   0.21516   0.26750   0.29455   0.15266
LYS  HNZ   H___A  side   0.33000   0.34000   0.21516   0.26750   0.29455   0.15266
LYS  HNZ   H___A  side   0.33000   0.34000   0.21516   0.26750   0.29455   0.15266

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
LYN  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
LYN  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
LYN  CA    C_3    back   0.07000  -0.07206  -0.03165   0.07000  -0.07206  -0.03165
LYN  HCA   H_     back   0.09000   0.09940   0.22426   0.09000   0.09940   0.22426
LYN  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
LYN  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
LYN  CB    C_3    side  -0.18000  -0.04845  -0.23792  -0.18000  -0.04845  -0.23792
LYN  HCB   H_     side   0.09000   0.03400   0.12268   0.09000   0.03400   0.12268
LYN  HCB   H_     side   0.09000   0.03400   0.12268   0.09000   0.03400   0.12268
LYN  CG    C_3    side  -0.18000   0.06612  -0.27772  -0.18000   0.06612  -0.27772
LYN  HCG   H_     side   0.09000   0.01041   0.13640   0.09000   0.01041   0.13640
LYN  HCG   H_     side   0.09000   0.01041   0.13640   0.09000   0.01041   0.13640
LYN  CD    C_3    side  -0.18000  -0.03768  -0.24200  -0.18000  -0.03768  -0.24200
LYN  HCD   H_     side   0.09000   0.01155   0.14783   0.09000   0.01155   0.14783
LYN  HCD   H_     side   0.09000   0.01155   0.14783   0.09000   0.01155   0.14783
LYN  CE    C_3    side   0.18000   0.32604  -0.19892   0.18000   0.32604  -0.19892
LYN  HCE   H_     side   0.05000  -0.03358   0.14114   0.05000  -0.03358   0.14114
LYN  HCE   H_     side   0.05000  -0.03358   0.14114   0.05000  -0.03358   0.14114
LYN  NZ    N_3P   side  -0.96000  -1.03581  -0.50026  -0.96000  -1.03581  -0.50026
LYN  HNZ   H___A  side   0.34000   0.38604   0.18036   0.34000   0.38604   0.18036
LYN  HNZ   H___A  side   0.34000   0.38604   0.18036   0.34000   0.38604   0.18036

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
MET  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
MET  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
MET  CA    C_3    back   0.07000  -0.02370  -0.03165   0.07000  -0.02370  -0.03165
MET  HCA   H_     back   0.09000   0.08800   0.22426   0.09000   0.08800   0.22426
MET  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
MET  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
MET  CB    C_3    side  -0.18000   0.03420  -0.26915  -0.18000   0.03420  -0.26915
MET  HCB   H_     side   0.09000   0.02410   0.11444   0.09000   0.02410   0.11444
MET  HCB   H_     side   0.09000   0.02410   0.11444   0.09000   0.02410   0.11444
MET  CG    C_3    side  -0.14000   0.00180  -0.29923  -0.14000   0.00180  -0.29923
MET  HCG   H_     side   0.09000   0.04400   0.11991   0.09000   0.04400   0.11991
MET  HCG   H_     side   0.09000   0.04400   0.11991   0.09000   0.04400   0.11991
MET  SD    S_3    side  -0.09000  -0.27370   0.21093  -0.09000  -0.27370   0.21093
MET  CE    C_3    side  -0.22000  -0.05360  -0.40768  -0.22000  -0.05360  -0.40768
MET  HCE   H_     side   0.09000   0.06840   0.09881   0.09000   0.06840   0.09881
MET  HCE   H_     side   0.09000   0.06840   0.09881   0.09000   0.06840   0.09881
MET  HCE   H_     side   0.09000   0.06840   0.09881   0.09000   0.06840   0.09881

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
PHE  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
PHE  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
PHE  CA    C_3    back   0.07000  -0.00240  -0.03165   0.07000  -0.00240  -0.03165
PHE  HCA   H_     back   0.09000   0.09780   0.22426   0.09000   0.09780   0.22426
PHE  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
PHE  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
PHE  CB    C_3    side  -0.18000  -0.03430  -0.23238  -0.18000  -0.03430  -0.23238
PHE  HCB   H_     side   0.09000   0.02950   0.09936   0.09000   0.02950   0.09936
PHE  HCB   H_     side   0.09000   0.02950   0.09936   0.09000   0.02950   0.09936
PHE  CG    C_R    side   0.00000   0.01180   0.00626   0.00000   0.01180   0.00626
PHE  CD1   C_R    side  -0.11500  -0.12560  -0.07417  -0.11500  -0.12560  -0.07417
PHE  HCD1  H_     side   0.11500   0.13300   0.10048   0.11500   0.13300   0.10048
PHE  CD2   C_R    side  -0.11500  -0.12560  -0.07417  -0.11500  -0.12560  -0.07417
PHE  HCD2  H_     side   0.11500   0.13300   0.10048   0.11500   0.13300   0.10048
PHE  CE1   C_R    side  -0.11500  -0.17040  -0.11103  -0.11500  -0.17040  -0.11103
PHE  HCE1  H_     side   0.11500   0.14300   0.10035   0.11500   0.14300   0.10035
PHE  CE2   C_R    side  -0.11500  -0.17040  -0.11103  -0.11500  -0.17040  -0.11103
PHE  HCE2  H_     side   0.11500   0.14300   0.10035   0.11500   0.14300   0.10035
PHE  CZ    C_R    side  -0.11500  -0.10720  -0.10756  -0.11500  -0.10720  -0.10756
PHE  HCZ   H_     side   0.11500   0.12970   0.10370   0.11500   0.12970   0.10370

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
PRO  N     N_R    back  -0.29000  -0.25480  -0.29671  -0.29000  -0.25480  -0.29671
PRO  CA    C_3    back   0.02000  -0.02660   0.07225   0.02000  -0.02660   0.07225
PRO  HCA   H_     back   0.09000   0.06410   0.10840   0.09000   0.06410   0.10840
PRO  C     C_2    back   0.51000   0.58960   0.28178   0.51000   0.58960   0.28178
PRO  O     O_2    back  -0.51000  -0.57480  -0.34112  -0.51000  -0.57480  -0.34112
PRO  CB    C_3    back  -0.18000  -0.00700  -0.24263  -0.18000  -0.00700  -0.24263
PRO  HCB   H_     back   0.09000   0.02530   0.10515   0.09000   0.02530   0.10515
PRO  HCB   H_     back   0.09000   0.02530   0.10515   0.09000   0.02530   0.10515
PRO  CG    C_3    back  -0.18000   0.01890  -0.23077  -0.18000   0.01890  -0.23077
PRO  HCG   H_     back   0.09000   0.02130   0.11867   0.09000   0.02130   0.11867
PRO  HCG   H_     back   0.09000   0.02130   0.11867   0.09000   0.02130   0.11867
PRO  CD    C_3    back   0.00000   0.01920  -0.05342   0.00000   0.01920  -0.05342
PRO  HCD   H_     back   0.09000   0.03910   0.12729   0.09000   0.03910   0.12729
PRO  HCD   H_     back   0.09000   0.03910   0.12729   0.09000   0.03910   0.12729

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
SER  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
SER  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
SER  CA    C_3    back   0.07000  -0.02490  -0.03165   0.07000  -0.02490  -0.03165
SER  HCA   H_     back   0.09000   0.08430   0.22426   0.09000   0.08430   0.22426
SER  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
SER  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
SER  CB    C_3    side   0.05000   0.21170  -0.00998   0.05000   0.21170  -0.00998
SER  HCB   H_     side   0.09000   0.03520   0.11153   0.09000   0.03520   0.11153
SER  HCB   H_     side   0.09000   0.03520   0.11153   0.09000   0.03520   0.11153
SER  OG    O_3    side  -0.66000  -0.65460  -0.43593  -0.66000  -0.65460  -0.43593
SER  HOG   H___A  side   0.43000   0.42750   0.22285   0.43000   0.42750   0.22285

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
THR  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
THR  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
THR  CA    C_3    back   0.07000  -0.03890  -0.03165   0.07000  -0.03890  -0.03165
THR  HCA   H_     back   0.09000   0.10070   0.22426   0.09000   0.10070   0.22426
THR  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
THR  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
THR  CB    C_3    side   0.14000   0.36540   0.04226   0.14000   0.36540   0.04226
THR  HCB   H_     side   0.09000   0.00430   0.12904   0.09000   0.00430   0.12904
THR  OG1   O_3    side  -0.66000  -0.67610  -0.43264  -0.66000  -0.67610  -0.43264
THR  HOG1  H___A  side   0.43000   0.41020   0.22434   0.43000   0.41020   0.22434
THR  CG2   C_3    side  -0.27000  -0.24380  -0.28370  -0.27000  -0.24380  -0.28370
THR  HCG2  H_     side   0.09000   0.06420   0.10690   0.09000   0.06420   0.10690
THR  HCG2  H_     side   0.09000   0.06420   0.10690   0.09000   0.06420   0.10690
THR  HCG2  H_     side   0.09000   0.06420   0.10690   0.09000   0.06420   0.10690

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
TRP  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
TRP  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
TRP  CA    C_3    back   0.07000  -0.02750  -0.03165   0.07000  -0.02750  -0.03165
TRP  HCA   H_     back   0.09000   0.11230   0.22426   0.09000   0.11230   0.22426
TRP  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
TRP  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
TRP  CB    C_3    side  -0.18000  -0.00500  -0.23653  -0.18000  -0.00500  -0.23653
TRP  HCB   H_     side   0.09000   0.03390   0.09874   0.09000   0.03390   0.09874
TRP  HCB   H_     side   0.09000   0.03390   0.09874   0.09000   0.03390   0.09874
TRP  CG    C_R    side  -0.03000  -0.14150   0.00032  -0.03000  -0.14150   0.00032
TRP  CD1   C_R    side   0.03500  -0.16380  -0.01512   0.03500  -0.16380  -0.01512
TRP  HCD1  H_     side   0.11500   0.20620   0.11393   0.11500   0.20620   0.11393
TRP  CD2   C_R    side  -0.02000   0.12430   0.10065  -0.02000   0.12430   0.10065
TRP  NE1   N_R    side  -0.61000  -0.34180  -0.44680  -0.61000  -0.34180  -0.44680
TRP  HNE1  H___A  side   0.38000   0.34120   0.17761   0.38000   0.34120   0.17761
TRP  CE2   C_R    side   0.13000   0.13800   0.15089   0.13000   0.13800   0.15089
TRP  CE3   C_R    side  -0.11500  -0.23870  -0.10925  -0.11500  -0.23870  -0.10925
TRP  HCE3  H_     side   0.11500   0.17000   0.09741   0.11500   0.17000   0.09741
TRP  CZ2   C_R    side  -0.11500  -0.26010  -0.07750  -0.11500  -0.26010  -0.07750
TRP  HCZ2  H_     side   0.11500   0.15720   0.10134   0.11500   0.15720   0.10134
TRP  CZ3   C_R    side  -0.11500  -0.19720  -0.13484  -0.11500  -0.19720  -0.13484
TRP  HCZ3  H_     side   0.11500   0.14470   0.10934   0.11500   0.14470   0.10934
TRP  CH2   C_R    side  -0.11500  -0.11340  -0.13568  -0.11500  -0.11340  -0.13568
TRP  HCH2  H_     side   0.11500   0.14170   0.10675   0.11500   0.14170   0.10675

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
TYR  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
TYR  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
TYR  CA    C_3    back   0.07000  -0.00140  -0.03165   0.07000  -0.00140  -0.03165
TYR  HCA   H_     back   0.09000   0.08760   0.22426   0.09000   0.08760   0.22426
TYR  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
TYR  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
TYR  CB    C_3    side  -0.18000  -0.01520  -0.20527  -0.18000  -0.01520  -0.20527
TYR  HCB   H_     side   0.09000   0.02950   0.10358   0.09000   0.02950   0.10358
TYR  HCB   H_     side   0.09000   0.02950   0.10358   0.09000   0.02950   0.10358
TYR  CG    C_R    side   0.00000  -0.00110  -0.02066   0.00000  -0.00110  -0.02066
TYR  CD1   C_R    side  -0.11500  -0.19060  -0.10460  -0.11500  -0.19060  -0.10460
TYR  HCD1  H_     side   0.11500   0.16990   0.10286   0.11500   0.16990   0.10286
TYR  CD2   C_R    side  -0.11500  -0.19060  -0.10460  -0.11500  -0.19060  -0.10460
TYR  HCD2  H_     side   0.11500   0.16990   0.10286   0.11500   0.16990   0.10286
TYR  CE1   C_R    side  -0.11500  -0.23410  -0.05159  -0.11500  -0.23410  -0.05159
TYR  HCE1  H_     side   0.11500   0.16560   0.10560   0.11500   0.16560   0.10560
TYR  CE2   C_R    side  -0.11500  -0.23410  -0.05159  -0.11500  -0.23410  -0.05159
TYR  HCE2  H_     side   0.11500   0.16560   0.10560   0.11500   0.16560   0.10560
TYR  CZ    C_R    side   0.11000   0.32260   0.15556   0.11000   0.32260   0.15556
TYR  OH    O_R    side  -0.54000  -0.55790  -0.45139  -0.54000  -0.55790  -0.45139
TYR  HOH   H___A  side   0.43000   0.39920   0.21006   0.43000   0.39920   0.21006

res  atom  ff     s/b     charmm     amber       qeq  charmm_n   amber_n     qeq_n
VAL  N     N_R    back  -0.47000  -0.41570  -0.36910  -0.47000  -0.41570  -0.36910
VAL  HN    H___A  back   0.31000   0.27190   0.25090   0.31000   0.27190   0.25090
VAL  CA    C_3    back   0.07000  -0.08750  -0.03165   0.07000  -0.08750  -0.03165
VAL  HCA   H_     back   0.09000   0.09690   0.22426   0.09000   0.09690   0.22426
VAL  C     C_R    back   0.51000   0.59730   0.27455   0.51000   0.59730   0.27455
VAL  O     O_2    back  -0.51000  -0.56790  -0.34896  -0.51000  -0.56790  -0.34896
VAL  CB    C_3    side  -0.09000   0.29850  -0.16998  -0.09000   0.29850  -0.16998
VAL  HCB   H_     side   0.09000  -0.02970   0.14034   0.09000  -0.02970   0.14034
VAL  CG1   C_3    side  -0.27000  -0.31920  -0.32502  -0.27000  -0.31920  -0.32502
VAL  HCG1  H_     side   0.09000   0.07910   0.11328   0.09000   0.07910   0.11328
VAL  HCG1  H_     side   0.09000   0.07910   0.11328   0.09000   0.07910   0.11328
VAL  HCG1  H_     side   0.09000   0.07910   0.11328   0.09000   0.07910   0.11328
VAL  CG2   C_3    side  -0.27000  -0.31920  -0.32502  -0.27000  -0.31920  -0.32502
VAL  HCG2  H_     side   0.09000   0.07910   0.11328   0.09000   0.07910   0.11328
VAL  HCG2  H_     side   0.09000   0.07910   0.11328   0.09000   0.07910   0.11328
VAL  HCG2  H_     side   0.09000   0.07910   0.11328   0.09000   0.07910   0.11328
";

my @chgdatlines = split(/\n/, $chgdat);
my %dat = ();
foreach $line (@chgdatlines) {
    if ($line =~ /^(ALA|ARN|ASN|APP|CYS|CYX|GLN|GLP|GLY|HIS|HSD|HSE|
		    ILE|LEU|LYN|MET|PHE|PRO|SER|THR|TRP|TYR|VAL|
		    ARG|ASP|GLU|GLU|HSP|LYS)/x) {
	@split = split(/\s+/, $line);
	$res   = $split[0];
	$atom  = $split[1];
	$dat{$res}{$atom}{charmm}   = $split[4];
	$dat{$res}{$atom}{amber}    = $split[5];
	$dat{$res}{$atom}{qeq}      = $split[6];
	$dat{$res}{$atom}{charmm_n} = $split[7];
	$dat{$res}{$atom}{amber_n}  = $split[8];
	$dat{$res}{$atom}{qeq_n}    = $split[9];
    }
}

###
### Libraries
###

@libraries = glob "*.lib";

foreach $lib (@libraries) {
    $newlibtxt = "";

    open LIB, "$lib";
    while (<LIB>) {
	$line = $_;
	if ($line =~ /^ATOM/) {
	    @split = split(/\s+/, $line);
	    $res    = $split[3];
	    $atom   = $split[2];
	    $charge = $dat{$res}{$atom}{$chargetype};
	    substr($line,72,8) = sprintf "%8.5f", $charge;
	}
	$newlibtxt .= $line;
    }
    close LIB;
    
    open LIB, ">${lib}.new";
    print LIB $newlibtxt;
    close LIB;

    move("${lib}.new", "$lib");
}

#REM D rotamer 1 (original numbering is 1)
#REM energy 2.903 0.147 0.248 0.043 0.001 0.000 2.462 0.000 0.000 
#REM library_name 20
#ATOM       1  N    ASP A    2   -0.97885   0.54464  -0.89525 N_R    3 0 -0.47000
#ATOM       2  CA   ASP A    2    0.00000   0.00000   0.00000 C_3    4 0  0.07000
#ATOM       3 HCA   ASP A    2   -0.51840  -0.53503   0.79568 H_     1 0  0.09000
#ATOM       4  C    ASP A    2    0.85027   1.07279   0.59397 C_R    3 0  0.51000
#ATOM       5  CB   ASP A    2    0.90944  -0.99971  -0.75082 C_3    4 0 -0.28000
#ATOM       6 HCB   ASP A    2    1.42749  -0.47899  -1.56011 H_     1 0  0.09000
#ATOM       7 HCB   ASP A    2    1.66120  -1.39260  -0.06266 H_     1 0  0.09000
#ATOM       8  CG   ASP A    2    0.15882  -2.13678  -1.30820 C_R    3 0  0.62000
#ATOM       9  OD1  ASP A    2   -0.43556  -2.93889  -0.55407 O_2    1 2 -0.76000
#ATOM      10  OD2  ASP A    2    0.11499  -2.32070  -2.54470 O_2    1 2 -0.76000
#012345678901234567890123456789012345678901234567890123456789012345678901234567890
#0         10        20        30        40        50        60        70        80
#                                                                        72+8

exit;

